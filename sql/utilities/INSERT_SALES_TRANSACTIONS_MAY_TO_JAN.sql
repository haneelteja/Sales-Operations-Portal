-- ==============================================
-- INSERT SALES TRANSACTIONS FROM MAY 2025 TO JANUARY 2026
-- This script inserts sales transactions by looking up customer_id
-- from the customers table using client_name, branch, and SKU
-- Handles negative cases (returns/adjustments) and name variations
-- ==============================================

WITH transaction_data AS (
  SELECT * FROM (VALUES 
    ('5/1/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', 19),
    ('5/1/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 65),
    ('5/1/2025', 'Good Vibes', 'Khajaguda', '500 P', 27),
    ('5/2/2025', 'This is it café', 'Sanikpuri', '500 P', 64),
    ('5/3/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 44),
    ('5/6/2025', 'Deccan kitchen', 'Film nagar', '750 P', 78),
    ('5/7/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 100),
    ('5/8/2025', 'Element E7', 'Kukatpally', '1000 P', 95),
    ('5/10/2025', 'House Party', 'Sanikpuri', '500 P', 75),
    ('5/10/2025', 'This is it café', 'Sanikpuri', '500 P', 75),
    ('5/13/2025', 'Gismat', 'Ameerpet', '500 P', 135),
    ('5/13/2025', 'Gismat', 'Dilshuknagar', '500 P', 150),
    ('5/17/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 75),
    ('5/17/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 75),
    ('5/18/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 311),
    ('5/18/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -1),
    ('5/19/2025', 'Element E7', 'Kukatpally', '1000 P', 120),
    ('5/20/2025', 'Gismat', 'Ameerpet', '500 P', 140),
    ('5/20/2025', 'Gismat', 'Chandha Nagar', '500 P', 40),
    ('5/23/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 150),
    ('5/24/2025', 'AAHA', 'Khajaguda', '500 AL', 67.5),
    ('5/24/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 250),
    ('5/24/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 370),
    ('5/28/2025', 'Deccan kitchen', 'Film nagar', '250 EC', 39),
    ('5/28/2025', 'Deccan kitchen', 'Film nagar', '750 P', 132),
    ('5/28/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 60),
    ('5/29/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('5/29/2025', 'Gismat', 'Pragathi nagar', '500 P', 50),
    ('5/30/2025', 'Atias Kitchen', 'Gandipet', '1000 P', 85),
    ('5/30/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 130),
    ('5/30/2025', 'Gismat', 'Kondapur', '500 P', 160),
    ('5/31/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 115),
    ('6/1/2025', 'Gismat', 'Dilshuknagar', '500 P', 153),
    ('6/1/2025', 'House Party', 'Sanikpuri', '500 P', 73),
    ('6/1/2025', 'This is it café', 'Sanikpuri', '500 P', 110),
    ('6/5/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 10),
    ('6/5/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', -4),
    ('6/5/2025', 'Good Vibes', 'Khajaguda', '500 P', 20),
    ('6/5/2025', 'Tara South Indian', 'Hitech City', '500 P', 20),
    ('6/6/2025', 'Element E7', 'Kukatpally', '1000 P', 50),
    ('6/6/2025', 'Gismat', 'Chandha Nagar', '500 P', 120),
    ('6/7/2025', 'Varsha grand Hotel', 'Bachupally', '1000 P', 1),
    ('6/7/2025', 'Varsha grand Hotel', 'Bachupally', '1000 P', -1),
    ('6/8/2025', 'Gismat', 'Ameerpet', '500 P', 58),
    ('6/10/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', 10),
    ('6/10/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', -10),
    ('6/11/2025', 'This is it café', 'Sanikpuri', '500 P', 42),
    ('6/12/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 38),
    ('6/12/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', 40),
    ('6/12/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', -20),
    ('6/12/2025', 'Gismat', 'Dilshuknagar', '500 P', 125),
    ('6/12/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 45),
    ('6/12/2025', 'Tara South Indian', 'Hitech City', '500 P', 150),
    ('6/13/2025', 'Element E7', 'Kukatpally', '1000 P', 95),
    ('6/14/2025', 'Gismat', 'Ameerpet', '500 P', 20),
    ('6/14/2025', 'Gismat', 'Ameerpet', '500 P', -20),
    ('6/14/2025', 'Gismat', 'Kondapur', '500 P', 20),
    ('6/14/2025', 'Gismat', 'Kondapur', '500 P', -20),
    ('6/15/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 125),
    ('6/15/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 29),
    ('6/15/2025', 'Tilaks kitchen', 'Madhapur', '500 P', -1),
    ('6/17/2025', 'Gismat', 'Ameerpet', '500 P', 150),
    ('6/18/2025', 'House Party', 'Sanikpuri', '500 P', 60),
    ('6/21/2025', 'Gismat', 'Dilshuknagar', '500 P', 50),
    ('6/21/2025', 'Varsha grand Hotel', 'Bachupally', '1000 P', 25),
    ('6/22/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 160),
    ('6/22/2025', 'Gismat', 'Lakshmipuram', '500 P', 160),
    ('6/22/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 55),
    ('6/24/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -10),
    ('6/24/2025', 'Element E7', 'Kukatpally', '1000 P', 110),
    ('6/24/2025', 'Varsha grand Hotel', 'Bachupally', '1000 P', 15),
    ('6/26/2025', 'Gismat', 'Dilshuknagar', '500 P', 85),
    ('6/26/2025', 'Krigo', 'Elluru', '1000 P', 74),
    ('6/26/2025', 'Mid land 1000 ml', 'Telangana', '1000 P', 64),
    ('6/26/2025', 'Tonique', 'Vijayawada', '1000 P', 162),
    ('6/26/2025', 'Tonique', 'Vijayawada', '1000 P', -1),
    ('6/27/2025', 'Gismat', 'Ameerpet', '500 P', 40),
    ('6/28/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 40),
    ('6/30/2025', 'Gismat', 'chandha Nagar', '500 P', 50),
    ('6/30/2025', 'Gismat', 'Pragathi nagar', '500 P', 50),
    ('7/1/2025', 'Alley 91', 'Nanakramguda', '500 P', 46),
    ('7/1/2025', 'Gismat', 'Kondapur', '500 P', 30),
    ('7/1/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 59),
    ('7/1/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', -0.34),
    ('7/1/2025', 'This is it café', 'Sanikpuri', '500 P', 100),
    ('7/2/2025', 'Element E7', 'Kukatpally', '1000 P', 102),
    ('7/2/2025', 'Gismat', 'Ameerpet', '500 P', 103.5),
    ('7/2/2025', 'Gismat', 'Ameerpet', '500 P', 1.5),
    ('7/3/2025', 'Gismat', 'DilshukNagar', '500 P', 100),
    ('7/6/2025', 'House Party', 'Sanikpuri', '500 P', 55),
    ('7/6/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 22),
    ('7/6/2025', 'Gismat', 'Kondapur', '500 P', 30),
    ('7/6/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 100),
    ('7/9/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 90),
    ('7/9/2025', 'Gismat', 'Kondapur', '500 P', 80),
    ('7/9/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 70),
    ('7/11/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 90),
    ('7/12/2025', 'Gismat', 'Chandha Nagar', '500 P', 80),
    ('7/12/2025', 'Gismat', 'Ameerpet', '500 P', 70),
    ('7/12/2025', 'Deccan kitchen', 'Film nagar', '750 P', 50),
    ('7/14/2025', 'Gismat', 'DilshukNagar', '500 P', 80),
    ('7/14/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -10),
    ('7/14/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -5),
    ('7/15/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 190),
    ('7/15/2025', 'Gismat', 'Lakshmipuram', '500 P', 100),
    ('7/15/2025', 'Mid land 750 ml', 'Telangana', '750 AL', 80),
    ('7/15/2025', 'Gismat', 'Kondapur', '500 P', 49),
    ('7/15/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 60),
    ('7/18/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('7/18/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 100),
    ('7/20/2025', 'House Party', 'Sanikpuri', '500 P', 50),
    ('7/22/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 250),
    ('7/22/2025', 'Mid land 750 ml', 'Andhra Pradesh', '750 AL', 130),
    ('7/23/2025', 'Blossamin Spa', 'Tirumalagiri', '250 P', 35),
    ('7/23/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('7/24/2025', 'Gismat', 'DilshukNagar', '500 P', 100),
    ('7/25/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 250),
    ('7/25/2025', 'This is it café', 'Sanikpuri', '500 P', 50),
    ('7/25/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 50),
    ('7/25/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('7/25/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 59),
    ('7/26/2025', 'Blossamin Spa', 'Tirumalagiri', '250 P', 10),
    ('7/26/2025', 'Gismat', 'Ameerpet', '500 P', 70),
    ('7/26/2025', 'Element E7', 'Kukatpally', '1000 P', 80),
    ('7/27/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -5),
    ('7/29/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', 30),
    ('7/29/2025', 'Gismat', 'Pragathi nagar', '500 P', 50),
    ('7/29/2025', 'Gismat', 'Ameerpet', '500 P', 20),
    ('7/29/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('7/29/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', -3),
    ('7/31/2025', 'Atias Kitchen', 'Gandipet', '1000 P', 45),
    ('8/2/2025', 'Jagan Pan House', 'Bhoodan Pochampally', '1000 P', 80),
    ('8/2/2025', 'Jagan Pan House', 'Bhoodan Pochampally', '500 P', 30),
    ('8/2/2025', 'Mid land 750 ml', 'Telangana', '750 AL', 210),
    ('8/2/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 40),
    ('8/2/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 100),
    ('8/4/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 70),
    ('8/4/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('8/5/2025', 'Gismat', 'Dilshuknagar', '500 P', 50),
    ('8/5/2025', 'Gismat', 'Ameerpet', '500 P', 20),
    ('8/5/2025', 'Gismat', 'Chandha nagar', '500 P', 30),
    ('8/5/2025', 'Gismat', 'Ameerpet', '500 P', -20),
    ('8/5/2025', 'Gismat', 'Chandha nagar', '500 P', 20),
    ('8/5/2025', 'Element E7', 'Kukatpally', '1000 P', 100),
    ('8/6/2025', 'This is it café', 'Sanikpuri', '500 P', 52),
    ('8/6/2025', 'House Party', 'Sanikpuri', '500 P', 42),
    ('8/8/2025', 'Chandhu Poda Marriage Order', 'Ongole', '250 P', 245),
    ('8/8/2025', 'Chandhu Poda Marriage Order', 'Ongole', '250 P', -2),
    ('8/8/2025', 'Gismat', 'Lakshmipuram', '500 P', 150),
    ('8/8/2025', 'Gismat', 'Dilshuknagar', '500 P', 100),
    ('8/8/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 100),
    ('8/8/2025', 'Gismat', 'Kondapur', '500 P', 100),
    ('8/13/2025', 'Mid land 750 ml', 'Andhra Pradesh', '750 AL', 300),
    ('8/14/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('8/14/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 105),
    ('8/15/2025', 'Alley 91', 'Nanakramguda', '500 P', 25),
    ('8/15/2025', 'Fusion Aroma', 'Nallagandla', '1000 P', 40),
    ('8/16/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 100),
    ('8/16/2025', 'Gismat', 'Ameerpet', '500 P', 90),
    ('8/20/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 35),
    ('8/20/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('8/21/2025', 'House Party', 'Sanikpuri', '500 P', 38),
    ('8/21/2025', 'This is it café', 'Sanikpuri', '500 P', 40),
    ('8/21/2025', 'Alley 91', 'Nanakramguda', '250 EC', 10),
    ('8/22/2025', 'Gismat', 'Dilshuknagar', '500 P', 50),
    ('8/23/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('8/23/2025', 'Element E7', 'Kukatpally', '1000 P', 27),
    ('8/25/2025', 'Alley 91', 'Nanakramguda', '500 P', 25),
    ('8/25/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 55),
    ('8/25/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('8/25/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 20),
    ('8/26/2025', 'Mid land 750 ml', 'Telangana', '750 AL', 295),
    ('8/26/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 100),
    ('8/26/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 100),
    ('8/26/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 85),
    ('8/26/2025', 'Gismat', 'Kondapur', '500 P', 50),
    ('8/29/2025', 'House Party', 'Sanikpuri', '500 P', 25),
    ('8/29/2025', 'House Party', 'Sanikpuri', '500 P', -25),
    ('8/29/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 45),
    ('8/30/2025', 'Element E7', 'Kukatpally', '1000 P', 125),
    ('9/1/2025', 'Gismat', 'Dilshuknagar', '500 P', 80),
    ('9/1/2025', 'Gismat', 'Kondapur', '500 P', 65),
    ('9/1/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 89),
    ('9/5/2025', 'This is it café', 'Sanikpuri', '500 P', 19),
    ('9/5/2025', 'House Party', 'Sanikpuri', '500 P', 40),
    ('9/5/2025', 'Gismat', 'Dilshuknagar', '500 P', 120),
    ('9/6/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 250),
    ('9/8/2025', 'Tilaks Kitchen', 'Madhapur', '500 P', 98),
    ('9/8/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 120),
    ('9/8/2025', 'Alley 91', 'Nanakramguda', '500 P', 31),
    ('9/8/2025', 'Alley 91', 'Nanakramguda', '250 EC', 7),
    ('9/8/2025', 'Atias Kitchen', 'Gandipet', '1000 P', 42),
    ('9/9/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('9/9/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 35),
    ('9/9/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', -1),
    ('9/11/2025', 'This is it café', 'Sanikpuri', '500 P', 50),
    ('9/12/2025', 'Element E7', 'Kukatpally', '1000 P', 75),
    ('9/12/2025', 'Gismat', 'Pragathi Nagar', '500 P', 50),
    ('9/12/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('9/16/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 100),
    ('9/16/2025', 'Deccan kitchen', 'Film nagar', '750 P', 26),
    ('9/16/2025', 'Deccan kitchen', 'Film nagar', '750 P', -1),
    ('9/16/2025', 'This is it café', 'Sanikpuri', '500 P', 25),
    ('9/16/2025', 'House Party', 'Sanikpuri', '500 P', 35),
    ('9/16/2025', 'Gismat', 'Dilshuknagar', '500 P', 75),
    ('9/17/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 100),
    ('9/17/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('9/17/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 300),
    ('9/18/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('9/18/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('9/18/2025', 'Alley 91', 'Nanakramguda', '250 EC', 15),
    ('9/18/2025', 'Gismat', 'Kondapur', '500 P', 120),
    ('9/18/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 29),
    ('9/19/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 325),
    ('9/19/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 175),
    ('9/19/2025', 'Gismat', 'Lakshmipuram', '500 P', 200),
    ('9/23/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 27),
    ('9/23/2025', 'Alley 91', 'Nanakramguda', '500 P', 33),
    ('9/23/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', -33),
    ('9/23/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 33),
    ('9/23/2025', 'Deccan kitchen', 'Film nagar', '750 P', 30),
    ('9/23/2025', 'Deccan kitchen', 'Film nagar', '250 EC', 35),
    ('9/24/2025', 'Gismat', 'Dilshuknagar', '500 P', 120),
    ('9/26/2025', 'Gismat', 'Ameerpet', '500 P', 70),
    ('9/26/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 50),
    ('9/27/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('9/27/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 50),
    ('9/27/2025', 'Gismat', 'Chandha nagar', '500 P', 50),
    ('9/29/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 80),
    ('10/1/2025', 'House Party', 'Sanikpuri', '500 P', 50),
    ('10/1/2025', 'This is it café', 'Sanikpuri', '500 P', 60),
    ('10/1/2025', 'Element E7', 'Kukatpally', '1000 P', 100),
    ('10/6/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('10/6/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 111),
    ('10/6/2025', 'Tara South Indian', 'Hitech City', '500 P', 32),
    ('10/6/2025', 'Gismat', 'Dilshuknagar', '500 P', 100),
    ('10/7/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 100),
    ('10/7/2025', 'Alley 91', 'Nanakramguda', '500 P', 27),
    ('10/7/2025', 'Alley 91', 'Nanakramguda', '250 EC', 10),
    ('10/9/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 320),
    ('10/9/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 100),
    ('10/9/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('10/9/2025', 'AAHA', 'Khajaguda', '500 AL', 10),
    ('10/13/2025', 'House Party', 'Sanikpuri', '500 P', 70),
    ('10/14/2025', 'Deccan kitchen', 'Film nagar', '750 P', 64),
    ('10/14/2025', 'Gismat', 'Kondapur', '500 P', 100),
    ('10/14/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 55),
    ('10/15/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 100),
    ('10/15/2025', 'Gismat', 'Dilshuknagar', '500 P', 80),
    ('10/16/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 120),
    ('10/16/2025', 'This is it café', 'Sanikpuri', '500 P', 51),
    ('10/17/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('10/17/2025', 'Element E7', 'Kukatpally', '1000 P', 100),
    ('10/17/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('10/19/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 120),
    ('10/21/2025', 'Gismat', 'Lakshmipuram', '500 P', 175),
    ('10/21/2025', 'Gismat', 'Tenali', '500 P', 175),
    ('10/23/2025', 'Gismat', 'Dilshuknagar', '500 P', 120),
    ('10/23/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 20),
    ('10/23/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', -20),
    ('10/25/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('10/25/2025', 'Tara South Indian', 'Hitech City', '500 P', 100),
    ('10/27/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 70),
    ('10/27/2025', 'Gismat', 'Main office', '500 P', 10),
    ('10/27/2025', 'soul of south', 'Film nagar', '500 P', 49),
    ('10/27/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 300),
    ('10/31/2025', 'Gismat', 'Chandha nagar', '500 P', 40),
    ('10/31/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 31),
    ('10/31/2025', 'AAHA', 'Khajaguda', '500 AL', 115),
    ('10/31/2025', 'House Party', 'Sanikpuri', '500 P', 30),
    ('10/31/2025', 'This is it café', 'Sanikpuri', '500 P', 40),
    ('11/2/2025', 'Alley 91', 'Nanakramguda', '500 P', 50),
    ('11/2/2025', 'Alley 91', 'Nanakramguda', '250 EC', 10),
    ('11/2/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -20),
    ('11/2/2025', 'Biryanis and More', 'Ameerpet', '1000 P', -11.66666667),
    ('11/3/2025', 'Gismat', 'Ameerpet', '500 P', 30),
    ('11/3/2025', 'Gismat', 'Kondapur', '500 P', 20),
    ('11/3/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 50),
    ('11/4/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 40),
    ('11/5/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 40),
    ('11/5/2025', 'Gismat', 'Dilshuknagar', '500 P', 80),
    ('11/5/2025', 'Gismat', 'Dilshuknagar', '500 P', -25),
    ('11/5/2025', 'Gismat', 'Dilshuknagar', '500 P', 25),
    ('11/5/2025', 'Gismat', 'Ameerpet', '500 P', -25),
    ('11/5/2025', 'Gismat', 'Ameerpet', '500 P', 25),
    ('11/5/2025', 'Gismat', 'Ameerpet', '500 P', 80),
    ('11/5/2025', 'Intercity', 'Bachupally', '500 EC', 30),
    ('11/6/2025', 'Gismat', 'Kondapur', '500 P', 100),
    ('11/6/2025', 'Element E7', 'Kukatpally', '1000 P', 120),
    ('11/6/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 100),
    ('11/6/2025', '1980s Milatry Hotel', 'Khajaguda', '750 AL', 80),
    ('11/7/2025', 'Gismat', 'Pragathi Nagar', '500 P', 50),
    ('11/7/2025', 'Intercity', 'Bachupally', '500 EC', 30),
    ('11/8/2025', 'AAHA', 'Khajaguda', '500 AL', 104),
    ('11/8/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 60),
    ('11/8/2025', 'Intercity', 'Bachupally', '500 EC', 30),
    ('11/8/2025', 'This is it café', 'Sanikpuri', '500 P', 60),
    ('11/8/2025', 'House Party', 'Sanikpuri', '500 P', 60),
    ('11/10/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 70),
    ('11/10/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/11/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 100),
    ('11/11/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('11/12/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/13/2025', 'Intercity', 'Bachupally', '500 EC', 40),
    ('11/14/2025', 'Intercity', 'Bachupally', '500 EC', 40),
    ('11/15/2025', 'Intercity', 'Bachupally', '500 EC', 40),
    ('11/16/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/17/2025', 'Maryadha Ramanna', 'L B Nagar', '500 P', 100),
    ('11/17/2025', 'Gismat', 'Dilshuknagar', '500 P', 100),
    ('11/18/2025', 'Golden pavilion', 'Banjara Hills', '750 AL', 40),
    ('11/18/2025', 'Gismat', 'Ameerpet', '500 P', 100),
    ('11/18/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/19/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 55),
    ('11/19/2025', 'Gismat', 'Chandha nagar', '500 P', 50),
    ('11/20/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/21/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 100),
    ('11/21/2025', 'AAHA', 'Khajaguda', '500 AL', 110),
    ('11/21/2025', 'Deccan kitchen', 'Film nagar', '750 P', 45),
    ('11/22/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('11/22/2025', 'This is it café', 'Sanikpuri', '500 P', 45),
    ('11/22/2025', 'soul of south', 'Film nagar', '500 P', 50),
    ('11/22/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/24/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/25/2025', 'Gismat', 'Kondapur', '500 P', 100),
    ('11/25/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 50),
    ('11/26/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/28/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('11/29/2025', 'Gismat', 'Chandha nagar', '500 P', 60),
    ('11/29/2025', 'Element E7', 'Kukatpally', '1000 P', 82),
    ('11/29/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('11/29/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/1/2025', 'Gismat', 'Dilshuknagar', '500 P', 85),
    ('12/1/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/2/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/2/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 350),
    ('12/3/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/4/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/4/2025', 'Alley 91', 'Nanakramguda', '500 P', 50),
    ('12/4/2025', 'This is it café', 'Sanikpuri', '500 P', 65),
    ('12/5/2025', 'Deccan kitchen', 'Film nagar', '750 P', 67),
    ('12/5/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 120),
    ('12/5/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 63),
    ('12/6/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/8/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 100),
    ('12/8/2025', 'Gismat', 'Dilshuknagar', '500 P', 120),
    ('12/8/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/9/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/10/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/10/2025', 'Alley 91', 'Nanakramguda', '500 P', 30),
    ('12/10/2025', 'Alley 91', 'Nanakramguda', '250 EC', 20),
    ('12/10/2025', 'Tara South Indian', 'Hitech City', '500 P', 136),
    ('12/12/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/13/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/14/2025', 'Intercity', 'Bachupally', '500 EC', 40),
    ('12/15/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/15/2025', 'Alley 91', 'Nanakramguda', '250 EC', 25),
    ('12/15/2025', 'Maryadha Ramanna', 'Kondapur', '500 P', 28),
    ('12/16/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/16/2025', 'Gismat', 'Chandha Nagar', '500 P', 75),
    ('12/17/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/18/2025', 'Intercity', 'Bachupally', '500 EC', 39),
    ('12/19/2025', 'House Party', 'Sanikpuri', '500 P', 52),
    ('12/19/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 80),
    ('12/19/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/20/2025', 'Element E7', 'Kukatpally', '1000 P', 100),
    ('12/20/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/20/2025', 'Gismat', 'Dilshuknagar', '500 P', 80),
    ('12/20/2025', 'Benguluru Bhavan', 'Kondapur', '500 P', 118),
    ('12/20/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 35),
    ('12/20/2025', 'Hiyya Chrono Jail Mandi', 'Madhapur', '500 P', 97),
    ('12/21/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/21/2025', 'This is it café', 'Sanikpuri', '500 P', 19),
    ('12/22/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/23/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 350),
    ('12/23/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/23/2025', 'soul of south', 'Film nagar', '500 P', 55),
    ('12/23/2025', 'soul of south', 'Film nagar', '500 P', -1),
    ('12/23/2025', 'Alley 91', 'Nanakramguda', '250 EC', 30),
    ('12/23/2025', 'Alley 91', 'Nanakramguda', '500 P', 50),
    ('12/23/2025', 'Tawalogy', 'Gandipet', '1000 P', 50),
    ('12/23/2025', 'Gismat', 'Ameerpet', '500 P', 80),
    ('12/23/2025', 'This is it café', 'Sanikpuri', '500 P', 55),
    ('12/24/2025', 'Gismat', 'Dilshuknagar', '500 P', 100),
    ('12/24/2025', 'Gismat', 'Kondapur', '500 P', 105),
    ('12/24/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/25/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/26/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/27/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/27/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 100),
    ('12/27/2025', 'Chaitanya''s Modern Kitchen', 'Khajaguda', '500 P', 128),
    ('12/28/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 70),
    ('12/28/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/29/2025', 'Biryanis and More', 'Ameerpet', '1000 P', 330),
    ('12/29/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/30/2025', 'Intercity', 'Bachupally', '500 EC', 50),
    ('12/31/2025', 'Tilaks kitchen', 'Madhapur', '500 P', 109),
    ('12/31/2025', 'Hiyya Chrono Jail Mandi', 'Madhapur', '500 P', 100),
    ('12/31/2025', 'Golden Pavilion', 'Banjara Hills', '750 AL', 50),
    ('1/1/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/2/2026', 'Golden Pavilion', 'Banjara Hills', '750 AL', 29),
    ('1/2/2026', 'Benguluru Bhavan', 'Kondapur', '500 P', 105),
    ('1/2/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/2/2026', 'Element E7', 'Kukatpally', '1000 P', 120),
    ('1/2/2026', 'Gismat', 'Dilshuknagar', '500 P', 100),
    ('1/2/2026', 'This is it café', 'Sanikpuri', '500 P', 73),
    ('1/2/2026', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('1/2/2026', 'House Party', 'Sanikpuri', '500 P', 50),
    ('1/3/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/4/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/4/2026', 'Biryanis and More', 'Ameerpet', '1000 P', 50),
    ('1/4/2026', 'Gismat', 'Chandha Nagar', '500 P', 50),
    ('1/5/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/6/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/6/2026', 'Biryanis and More', 'Ameerpet', '1000 P', 58),
    ('1/6/2026', 'Gismat', 'Ameerpet', '500 P', 70),
    ('1/6/2026', 'Happy Monkeys', 'Nagole', '500 P', 50),
    ('1/7/2026', 'Alley 91', 'Nanakramguda', '500 P', 50),
    ('1/7/2026', 'Alley 91', 'Nanakramguda', '250 EC', 42),
    ('1/7/2026', 'soul of south', 'Film nagar', '500 P', 75),
    ('1/7/2026', 'Gismat', 'Kondapur', '500 P', 110),
    ('1/7/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/7/2026', 'Biryanis and More', 'Ameerpet', '1000 P', 41),
    ('1/8/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/9/2026', 'Gismat', 'Dilshuknagar', '500 P', 130),
    ('1/9/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/9/2026', 'Alley 91', 'Nanakramguda', '250 EC', 50),
    ('1/10/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/11/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/12/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/13/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/14/2026', 'Intercity', 'Bachupally', '500 EC', 50),
    ('1/14/2026', 'Hiyya Chrono Jail Mandi', 'Madhapur', '500 P', 100),
    ('1/14/2026', 'Benguluru Bhavan', 'Kondapur', '500 P', 100),
    ('1/16/2026', 'Intercity', 'Bachupally', '500 EC', 50)
  ) AS t(transaction_date_str, client_name, branch, sku, cases)
),
-- Convert date from MM/DD/YYYY to DATE format and normalize client/branch names
prepared_data AS (
  SELECT 
    TO_DATE(transaction_date_str, 'MM/DD/YYYY') as transaction_date,
    -- Normalize client names (handle variations)
    CASE 
      WHEN UPPER(TRIM(client_name)) = 'AAHA' THEN 'Aaha'
      WHEN UPPER(TRIM(client_name)) = 'BENGULURU BHAVAN' THEN 'benguluru Bhavan'
      WHEN UPPER(TRIM(client_name)) = 'GOLDEN PAVILION' OR UPPER(TRIM(client_name)) = 'GOLDEN PAVILION' THEN 'Golden Pavilion'
      WHEN UPPER(TRIM(client_name)) = 'TILAKS KITCHEN' THEN 'Tilaks kitchen'
      WHEN UPPER(TRIM(client_name)) LIKE 'MID LAND%' THEN 'Mid land'
      WHEN UPPER(TRIM(client_name)) = 'JAGAN PAN HOUSE' THEN 'jagan Pan House'
      WHEN UPPER(TRIM(client_name)) = 'VARSHA GRAND HOTEL' THEN 'Varsha grand Hotel'
      ELSE TRIM(client_name)
    END as client_name,
    -- Normalize branch names (handle case variations)
    CASE 
      WHEN UPPER(TRIM(branch)) = 'DILSHUKNAGAR' OR UPPER(TRIM(branch)) = 'DILSHUKNAGAR' THEN 'Dilshuknagar'
      WHEN UPPER(TRIM(branch)) = 'CHANDHA NAGAR' OR UPPER(TRIM(branch)) = 'CHANDHA NAGAR' THEN 'Chandha Nagar'
      WHEN UPPER(TRIM(branch)) = 'PRAGATHI NAGAR' THEN 'Pragathi nagar'
      ELSE TRIM(branch)
    END as branch,
    sku,
    cases,
    -- Round cases to nearest integer for quantity (but keep decimal for amount calculation)
    ROUND(cases)::INTEGER as quantity
  FROM transaction_data
)
INSERT INTO sales_transactions (
  customer_id,
  transaction_type,
  amount,
  quantity,
  sku,
  description,
  transaction_date
)
SELECT 
  c.id as customer_id,
  'sale'::TEXT as transaction_type,
  -- Calculate amount: cases * price_per_case
  -- If price_per_case is NULL, use cases * price_per_bottle * bottles_per_case
  -- If both are NULL, set to 0 (you may need to update manually)
  COALESCE(
    (pd.cases * c.price_per_case),
    (pd.cases * c.price_per_bottle * COALESCE(sc.bottles_per_case, 1)),
    0
  ) as amount,
  pd.quantity,
  pd.sku,
  CASE 
    WHEN pd.cases < 0 THEN 'Return/Adjustment of ' || ABS(pd.cases) || ' cases'
    ELSE 'Sale of ' || pd.cases || ' cases'
  END as description,
  pd.transaction_date
FROM prepared_data pd
INNER JOIN customers c 
  ON UPPER(TRIM(c.client_name)) = UPPER(TRIM(pd.client_name))
  AND UPPER(TRIM(c.branch)) = UPPER(TRIM(pd.branch))
  AND c.sku = pd.sku
LEFT JOIN sku_configurations sc 
  ON sc.sku = pd.sku
ORDER BY pd.transaction_date, pd.client_name, pd.branch;

-- Verify the import
SELECT 
  'Sales Transactions Imported' as status,
  COUNT(*) as total_transactions,
  SUM(quantity) as total_quantity,
  SUM(amount) as total_amount,
  MIN(transaction_date) as earliest_date,
  MAX(transaction_date) as latest_date
FROM sales_transactions
WHERE transaction_date >= '2025-05-01';

-- Show transactions by client (summary)
SELECT 
  c.client_name,
  c.branch,
  COUNT(*) as transaction_count,
  SUM(st.quantity) as total_cases,
  SUM(st.amount) as total_amount
FROM sales_transactions st
INNER JOIN customers c ON st.customer_id = c.id
WHERE st.transaction_date >= '2025-05-01'
GROUP BY c.client_name, c.branch
ORDER BY c.client_name, c.branch;
